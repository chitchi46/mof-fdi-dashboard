# UI Controls Refactor

## 目的
- 共通（系列/年/地域）とビュー固有（TopN/並び/単年年）のコントロールを分離し、文脈に応じた表示を行う。
- 変更の可視性と操作コストを下げる（フィルタチップで状態を要約しワンクリック解除）。

## 追加要件（今回採用分）
- 棒グラフの向きトグル: 「縦棒」「横棒」をユーザーが切替可能（国別ランキングは横棒既定）。
- グラフタイプセレクタ: ユーザーが各パネルの表示種別を選択（例: 時系列/前年比差/構成比/棒(縦/横)/国別円）。
- マルチパネル設定: 表示するグラフ数（1/2/3/4）と並び（1×2/2×1/2×2）を選択できる UI。

## 作業分解
1. コンポーネント分割（CommonControls / ViewControls / PanelLayoutControls / ChartTypePicker）
2. 表示ルール実装（viewに応じたshow/hide、マルチパネル時の各パネル固有設定）
3. TopN スライダと並び替えメニューの共通化＋棒向きトグルの追加
4. フィルタチップの実装（生成・クリック解除、マルチパネル時は「全パネルに適用/このパネルのみ」を選択可能）
5. ChartTypePicker の状態を URL ハッシュ/LocalStorage へ保存・復元
6. 回帰確認（既存操作と互換）

## 受け入れ基準
- すべてのビューで不要なコントロールが表示されない
- フィルタチップで現在の状態が一目で分かり、クリック解除が可能
- 状態が URL/LocalStorage から復元できる
- 縦棒/横棒の切替が即時反映され、画像/CSV エクスポートと整合
- マルチパネルでグラフ数・種類をユーザーが選んだ通りに表示（各パネルの設定が保持される）
